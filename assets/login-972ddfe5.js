/* empty css             */import{E as T,a as U,v as z,b as M,u as O}from"./el-form-item-42addf79.js";import{E as R}from"./el-button-849a7448.js";import"./el-scrollbar-cbd3ff34.js";import{c as W,b as h}from"./https-1223c700.js";import{d as A,a2 as D,r as d,a6 as L,a1 as P,R as q,o as J,D as j,a as v,c as $,h as m,l as c,E as s,w as l,O as G,a0 as H,_ as b,bb as k,j as K}from"./index-f07c035b.js";/* empty css                   */import"./plugin-vue_export-helper-1cff8a04.js";import"./index-36588ac4.js";import"./typescript-defaf979.js";const Q={class:"login"},X={class:"form-container"},Y={class:"manage-tip"},Z={class:"title"},x={class:"tiparea"},pe=A({__name:"login",setup(ee){const{locale:y,t:i}=D(),V=d(["zh-TW","zh-CN","zh-EN"]),u=d({lang:"zh-TW"}),w=d(),S=L(),g=P(),n=d({username:"roy6874ya@yahoo.com.tw",password:"shit0704",email:"roy6874ya@yahoo.com.tw"}),I=q({email:[{type:"email",required:!0,message:i("mailErr"),trigger:"blur"}],password:[{required:!0,message:i("PWisEmpty"),trigger:"blur"},{min:6,max:30,message:i("sixTothirty"),trigger:"blur"}]}),N=()=>{y.value=u.value.lang},C=e=>{localStorage.setItem("lang",u.value.lang),e&&e.validate(async a=>{if(a){const p="https://vue3-course-api.hexschool.io/admin/signin";try{const{data:{success:o,token:r,message:_,uid:E}}=await W.post(p,n.value),f=JSON.parse(localStorage.getItem("memberInfo")||"{}");o&&r?(localStorage.setItem("memberInfo",JSON.stringify({...f,token:r})),g.setToken(r),g.setAuth(!!k(r)),g.setUser(k(r)),h({message:i("loginSuccess"),type:"success"}),S.push({path:"/"})):h({type:"error",message:_})}catch(o){console.error("err",o),console.error("err.response.data.msg",o.response.data.msg),h({message:o.response.data.msg,type:"error"})}}else return console.log("err submit"),!1})};return J(()=>{y.value=u.value.lang}),(e,a)=>{const p=T,o=U,r=O,_=z,E=R,f=j("router-link"),F=M;return v(),$("div",Q,[m("section",X,[m("div",Y,[m("span",Z,c(e.$t("sysName")),1),s(F,{rules:I,ref_key:"ruleFormRef",ref:w,model:n.value,class:"loginForm","label-width":"80px"},{default:l(()=>[s(o,{label:e.$t("mail"),prop:"username"},{default:l(()=>[s(p,{modelValue:n.value.username,"onUpdate:modelValue":a[0]||(a[0]=t=>n.value.username=t),placeholder:e.$t("keyMail")},null,8,["modelValue","placeholder"])]),_:1},8,["label"]),s(o,{label:e.$t("password"),prop:"password"},{default:l(()=>[s(p,{modelValue:n.value.password,"onUpdate:modelValue":a[1]||(a[1]=t=>n.value.password=t),placeholder:e.$t("keyPW"),type:"password"},null,8,["modelValue","placeholder"])]),_:1},8,["label"]),s(o,{label:e.$t("lang")},{default:l(()=>[s(_,{modelValue:u.value.lang,"onUpdate:modelValue":a[2]||(a[2]=t=>u.value.lang=t),onChange:N},{default:l(()=>[(v(!0),$(G,null,H(V.value,(t,B)=>(v(),K(r,{key:B,label:e.$t(`language.${t}`),value:t},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1},8,["label"]),s(o,null,{default:l(()=>[s(E,{onClick:a[3]||(a[3]=t=>C(w.value)),class:"submit-btn"},{default:l(()=>[b(c(e.$t("login")),1)]),_:1})]),_:1}),m("div",x,[m("p",null,[b(c(e.$t("noAcc")),1),s(f,{to:"/register"},{default:l(()=>[b(c(e.$t("register")),1)]),_:1})])])]),_:1},8,["rules","model"])])])])}}});export{pe as default};
