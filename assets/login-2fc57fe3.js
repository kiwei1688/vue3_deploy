/* empty css                     */import{d as B,ae as T,r as d,aj as z,ad as M,$ as W,o as A,H as L,a as h,c as $,j as m,m as c,I as s,w as t,U as O,ac as P,k as R,aa as v,ak as j,bE as w,ah as y}from"./index-9b92ae7c.js";import{E as q}from"./index-27b98533.js";import{a as D,t as J,u as H,E as G}from"./index-69ea01b9.js";import{E as K}from"./index-f356624c.js";import"./error-f1912ce6.js";import"./index-6cfaf5ed.js";const Q={class:"login"},X={class:"form-container"},Y={class:"manage-tip"},Z={class:"title"},x={class:"tiparea"},ue=B({__name:"login",setup(ee){const{locale:b,t:i}=T(),V=d(["zh-TW","zh-CN","zh-EN"]),u=d({lang:"zh-TW"}),k=d(),S=z(),g=M(),n=d({username:"roy6874ya@yahoo.com.tw",password:"shit0704",email:"roy6874ya@yahoo.com.tw"}),I=W({email:[{type:"email",required:!0,message:i("mailErr"),trigger:"blur"}],password:[{required:!0,message:i("PWisEmpty"),trigger:"blur"},{min:6,max:30,message:i("sixTothirty"),trigger:"blur"}]}),N=()=>{b.value=u.value.lang},C=e=>{localStorage.setItem("lang",u.value.lang),e&&e.validate(async a=>{if(a){const p="https://vue3-course-api.hexschool.io/admin/signin";try{const{data:{success:o,token:r,message:_,uid:E}}=await j.post(p,n.value),f=JSON.parse(localStorage.getItem("memberInfo")||"{}");o&&r?(localStorage.setItem("memberInfo",JSON.stringify({...f,token:r})),g.setToken(r),g.setAuth(!!w(r)),g.setUser(w(r)),y({message:i("loginSuccess"),type:"success"}),S.push({path:"/"})):y({type:"error",message:_})}catch(o){console.error("err",o),console.error("err.response.data.msg",o.response.data.msg),y({message:o.response.data.msg,type:"error"})}}else return console.log("err submit"),!1})};return A(()=>{b.value=u.value.lang}),(e,a)=>{const p=q,o=D,r=J,_=H,E=K,f=L("router-link"),F=G;return h(),$("div",Q,[m("section",X,[m("div",Y,[m("span",Z,c(e.$t("sysName")),1),s(F,{rules:I,ref_key:"ruleFormRef",ref:k,model:n.value,class:"loginForm","label-width":"80px"},{default:t(()=>[s(o,{label:e.$t("mail"),prop:"username"},{default:t(()=>[s(p,{modelValue:n.value.username,"onUpdate:modelValue":a[0]||(a[0]=l=>n.value.username=l),placeholder:e.$t("keyMail")},null,8,["modelValue","placeholder"])]),_:1},8,["label"]),s(o,{label:e.$t("password"),prop:"password"},{default:t(()=>[s(p,{modelValue:n.value.password,"onUpdate:modelValue":a[1]||(a[1]=l=>n.value.password=l),placeholder:e.$t("keyPW"),type:"password"},null,8,["modelValue","placeholder"])]),_:1},8,["label"]),s(o,{label:e.$t("lang")},{default:t(()=>[s(_,{modelValue:u.value.lang,"onUpdate:modelValue":a[2]||(a[2]=l=>u.value.lang=l),onChange:N},{default:t(()=>[(h(!0),$(O,null,P(V.value,(l,U)=>(h(),R(r,{key:U,label:e.$t(`language.${l}`),value:l},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1},8,["label"]),s(o,null,{default:t(()=>[s(E,{onClick:a[3]||(a[3]=l=>C(k.value)),class:"submit-btn"},{default:t(()=>[v(c(e.$t("login")),1)]),_:1})]),_:1}),m("div",x,[m("p",null,[v(c(e.$t("noAcc")),1),s(f,{to:"/register"},{default:t(()=>[v(c(e.$t("register")),1)]),_:1})])])]),_:1},8,["rules","model"])])])])}}});export{ue as default};
