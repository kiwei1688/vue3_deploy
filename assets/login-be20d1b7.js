import"./base-a89e4049.js";import{w as q,E as T,v as U,s as z,t as M}from"./el-form-item-5a29c62e.js";import{E as P}from"./el-button-a05ee2b1.js";import{h as W,g as $}from"./el-scrollbar-4f04b271.js";import{d as A,$ as L,b as d,b8 as O,_ as R,P as D,e as J,q as H,o as f,B as k,H as m,Z as c,s as l,w as t,K,a2 as Y,c as Z,Y as v,b9 as w}from"./index-5599dcdb.js";/* empty css                   */import"./typescript-defaf979.js";const j={class:"login"},G={class:"form-container"},Q={class:"manage-tip"},X={class:"title"},x={class:"tiparea"},ue=A({__name:"login",setup(ee){const{locale:b,t:i}=L(),E=d(["zh-TW","zh-CN","zh-EN"]),u=d({lang:"zh-TW"}),h=d(),V=O(),g=R(),n=d({email:"27732357@qq.com",password:"321321"}),S=D({email:[{type:"email",required:!0,message:i("mailErr"),trigger:"blur"}],password:[{required:!0,message:i("PWisEmpty"),trigger:"blur"},{min:6,max:30,message:i("sixTothirty"),trigger:"blur"}]}),I=()=>{b.value=u.value.lang},N=e=>{localStorage.setItem("lang",u.value.lang),e&&e.validate(async a=>{if(a){const p="/api/users/login";try{const{data:{success:s,token:r,msg:y}}=await W.post(p,n.value),_=JSON.parse(localStorage.getItem("memberInfo")||"{}");s&&r&&(localStorage.setItem("memberInfo",JSON.stringify({..._,token:r})),g.setToken(r),g.setAuth(!!w(r)),g.setUser(w(r)),$({message:i("loginSuccess"),type:"success"}),V.push({path:"/"}))}catch(s){console.error("err",s),console.error("err.response.data.msg",s.response.data.msg),$({message:s.response.data.msg,type:"error"})}}else return console.log("err submit"),!1})};return J(()=>{b.value=u.value.lang}),(e,a)=>{const p=T,s=U,r=z,y=M,_=P,C=H("router-link"),B=q;return f(),k("div",j,[m("section",G,[m("div",Q,[m("span",X,c(e.$t("sysName")),1),l(B,{rules:S,ref_key:"ruleFormRef",ref:h,model:n.value,class:"loginForm","label-width":"80px"},{default:t(()=>[l(s,{label:e.$t("mail"),prop:"email"},{default:t(()=>[l(p,{modelValue:n.value.email,"onUpdate:modelValue":a[0]||(a[0]=o=>n.value.email=o),placeholder:e.$t("keyMail")},null,8,["modelValue","placeholder"])]),_:1},8,["label"]),l(s,{label:e.$t("password"),prop:"password"},{default:t(()=>[l(p,{modelValue:n.value.password,"onUpdate:modelValue":a[1]||(a[1]=o=>n.value.password=o),placeholder:e.$t("keyPW"),type:"password"},null,8,["modelValue","placeholder"])]),_:1},8,["label"]),l(s,{label:e.$t("lang")},{default:t(()=>[l(y,{modelValue:u.value.lang,"onUpdate:modelValue":a[2]||(a[2]=o=>u.value.lang=o),onChange:I},{default:t(()=>[(f(!0),k(K,null,Y(E.value,(o,F)=>(f(),Z(r,{key:F,label:e.$t(`language.${o}`),value:o},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1},8,["label"]),l(s,null,{default:t(()=>[l(_,{onClick:a[3]||(a[3]=o=>N(h.value)),class:"submit-btn"},{default:t(()=>[v(c(e.$t("login"))+"sss",1)]),_:1})]),_:1}),m("div",x,[m("p",null,[v(c(e.$t("noAcc")),1),l(C,{to:"/register"},{default:t(()=>[v(c(e.$t("register")),1)]),_:1})])])]),_:1},8,["rules","model"])])])])}}});export{ue as default};
